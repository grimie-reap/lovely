<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Positvity - Lengkap</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap');

  :root {
    --color-primary: #ffafe6;
    --color-secondary: #f3e92b;
    --color-bg: #fefefe;
    --color-text-primary: #222;
    --color-text-secondary: #555;
    --radius: 12px;
    --transition: 0.3s ease;
  }

  * {
    box-sizing: border-box;
  }
  body {
    margin: 0;
    font-family: 'Poppins', sans-serif;
    background: var(--color-bg);
    color: var(--color-text-primary);
  }
  header {
    background: var(--color-primary);
    color: white;
    padding: 1.2rem 2rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0 2px 8px rgb(90 90 239 / 0.5);
    position: sticky;
    top: 0;
    z-index: 1000;
  }
  header h1 {
    margin: 0;
    font-weight: 600;
    font-size: 1.8rem;
    user-select: none;
  }
  button#profileBtn {
    background: var(--color-secondary);
    border: none;
    color: white;
    padding: 0.6rem 1.2rem;
    border-radius: var(--radius);
    font-weight: 600;
    font-size: 1rem;
    cursor: pointer;
    transition: background-color var(--transition);
  }
  button#profileBtn:hover {
    background: #d44e69;
  }
  /* Post Button Style */
  button#postBtn {
    background: var(--color-primary);
    border: none;
    color: #fff;
    padding: 0.6rem 1.4rem;
    border-radius: var(--radius);
    font-weight: 600;
    font-size: 1rem;
    cursor: pointer;
    margin-left: 1rem;
    transition: background-color var(--transition);
    box-shadow: 0 2px 8px rgb(243 233 43 / 0.12);
  }
  button#postBtn:hover {
    background: #fff174;
  }

  main {
    max-width: 1080px;
    margin: 2rem auto 3rem;
    padding: 0 1rem;
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 1.5rem;
  }
  .post-box {
    background: white;
    border-radius: var(--radius);
    box-shadow: 0 6px 16px rgb(0 0 0 / 0.1);
    overflow: hidden;
    cursor: pointer;
    display: flex;
    flex-direction: column;
    transition: transform var(--transition), box-shadow var(--transition);
  }
  .post-box:hover {
    transform: translateY(-5px);
    box-shadow: 0 14px 32px rgb(0 0 0 / 0.18);
  }
  .post-image {
    width: 100%;
    height: 160px;
    object-fit: cover;
  }
  .post-content {
    padding: 1rem 1rem 1.5rem;
    flex-grow: 1;
    display: flex;
    flex-direction: column;
  }
  .post-title {
    font-weight: 600;
    font-size: 1.2rem;
    margin: 0 0 0.5rem 0;
    color: var(--color-primary);
    user-select: none;
  }
  .post-excerpt {
    flex-grow: 1;
    color: var(--color-text-secondary);
    font-size: 0.95rem;
    line-height: 1.4;
    user-select: none;
  }

  /* Modal styling */
  .modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0,0,0,0.45);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 1200;
    overflow-y: auto;
    padding: 1rem;
  }
  .modal-overlay.active {
    display: flex;
  }
  .modal {
    background: white;
    border-radius: var(--radius);
    padding: 2rem 2.5rem;
    max-width: 600px;
    width: 100%;
    box-shadow: 0 10px 32px rgb(90 90 239 / 0.3);
    position: relative;
    user-select: text;
    max-height: 90vh;
    overflow-y: auto;
  }
  .modal h2 {
    margin-top: 0;
    margin-bottom: 0.8rem;
    color: var(--color-primary);
  }
  .modal p {
    color: var(--color-text-secondary);
    margin-bottom: 1rem;
    font-size: 1rem;
    line-height: 1.5;
  }
  .modal button.close-btn {
    position: absolute;
    top: 12px;
    right: 12px;
    background: var(--color-secondary);
    border: none;
    color: white;
    font-weight: 700;
    font-size: 1.2rem;
    width: 32px;
    height: 32px;
    border-radius: 50%;
    cursor: pointer;
    transition: background-color var(--transition);
  }
  .modal button.close-btn:hover {
    background: #d44e69;
  }

  /* Profile modal specific */
  .profile-pic {
    display: block;
    width: 96px;
    height: 96px;
    border-radius: 50%;
    object-fit: cover;
    margin-bottom: 1rem;
    border: 3px solid var(--color-primary);
  }
  .profile-username {
    font-weight: 700;
    font-size: 1.3rem;
    margin-bottom: 0.3rem;
    color: var(--color-primary);
  }
  .profile-bio {
    font-size: 1rem;
    color: var(--color-text-secondary);
  }

  /* Create Post Modal */
  .create-post-form label {
    font-weight: 600;
    color: var(--color-primary);
    display: block;
    margin-bottom: 0.3rem;
    margin-top: 1rem;
  }
  .create-post-form input, .create-post-form textarea {
    width: 100%;
    font-family: inherit;
    font-size: 1rem;
    margin-bottom: 0.8rem;
    padding: 0.55rem 0.8rem;
    border-radius: var(--radius);
    border: 1px solid #ddd;
    background: #fafafc;
    transition: border-color var(--transition);
    resize: vertical;
  }
  .create-post-form input:focus, .create-post-form textarea:focus {
    border-color: var(--color-primary);
    outline: none;
  }
  .create-post-form .attachment-label {
    display: flex;
    align-items: center;
    margin-bottom: 0.8rem;
    gap: 0.7rem;
    font-size: 1rem;
    font-weight: 500;
    color: var(--color-secondary);
    cursor: pointer;
  }
  .create-post-form input[type="file"] {
    display: none;
  }
  .create-post-form .attachment-preview {
    margin-bottom: 0.8rem;
    max-width: 100%;
    height: auto;
    border-radius: 8px;
    box-shadow: 0 1px 6px rgba(0,0,0,0.07);
  }
  .create-post-form .action-row {
    display: flex;
    justify-content: flex-end;
    gap: 0.7rem;
    margin-top: 1rem;
  }
  .create-post-form button[type="submit"] {
    background: var(--color-primary);
    border: none;
    color: white;
    padding: 0.6rem 1.4rem;
    border-radius: var(--radius);
    font-weight: 600;
    font-size: 1rem;
    cursor: pointer;
    transition: background-color var(--transition);
    box-shadow: 0 2px 8px rgb(243 233 43 / 0.12);
  }
  .create-post-form button[type="submit"]:hover {
    background: #d44e69;
  }
  .create-post-form button[type="button"] {
    background: #f3e92b;
    color: #fff;
    border: none;
    border-radius: var(--radius);
    padding: 0.6rem 1.2rem;
    cursor: pointer;
    font-weight: 600;
    font-size: 1rem;
    transition: background-color var(--transition);
  }
  .create-post-form button[type="button"]:hover {
    background: #e0c300;
  }

  @media (max-width: 480px) {
    main {
      grid-template-columns: 1fr;
      margin: 1rem auto 3rem;
    }
    .modal {
      padding: 1.5rem 1.5rem;
      max-width: 90vw;
    }
    button#postBtn {
      margin-left: 0.5rem;
      padding: 0.6rem 0.9rem;
      font-size: 0.97rem;
    }
    .create-post-form .action-row {
      flex-direction: column;
      gap: 0.3rem;
    }
  }
</style>
</head>
<body>
<header>
  <h1>bakedforyou</h1>
  <div>
    <button id="profileBtn">Profile</button>
    <button id="postBtn">Post</button>
  </div>
</header>
<main id="postsContainer" tabindex="0" aria-label="Daftar posting blog">
  <!-- Posts akan di-inject di sini -->
</main>

<!-- Modal profil -->
<div class="modal-overlay" id="profileModal" aria-hidden="true" role="dialog" aria-modal="true" aria-labelledby="profileTitle">
  <div class="modal">
    <button class="close-btn" id="closeProfileModal" aria-label="Tutup profil modal">&times;</button>
    <img src="https://stickershop.line-scdn.net/stickershop/v1/product/18810/LINEStorePC/main.png?v=1" alt="Foto Profil" class="profile-pic" />
    <h2 class="profile-username" id="profileTitle">@sainzus</h2>
    <p class="profile-bio">Hello! My name is Vinca and welcome to my cake diary! daily sharing all about cakes and dairies <3</p>
  </div>
</div>

<!-- Modal isi posting -->
<div class="modal-overlay" id="postModal" aria-hidden="true" role="dialog" aria-modal="true" aria-labelledby="postTitle">
  <div class="modal">
    <button class="close-btn" id="closePostModal" aria-label="Tutup isi posting modal">&times;</button>
    <h2 id="postTitle"></h2>
    <img id="postImage" src="" alt="" style="width: 100%; max-height: 300px; object-fit: cover; border-radius: 8px; margin-bottom: 1rem;" />
    <div id="postContent" style="color: var(--color-text-secondary); font-size: 1rem; line-height: 1.6;"></div>
  </div>
</div>

<!-- Modal Create Post -->
<div class="modal-overlay" id="createPostModal" aria-hidden="true" role="dialog" aria-modal="true" aria-labelledby="createPostTitle">
  <div class="modal">
    <button class="close-btn" id="closeCreatePostModal" aria-label="Tutup modal buat posting">&times;</button>
    <h2 id="createPostTitle" style="margin-bottom: 1.2rem;">Buat Postingan Baru</h2>
    <form class="create-post-form" id="createPostForm" autocomplete="off">
      <label for="postTitleInput">Judul</label>
      <input type="text" id="postTitleInput" name="title" maxlength="80" required placeholder="Insert post title" />

      <label for="postContentInput">Isi</label>
      <textarea id="postContentInput" name="content" rows="4" maxlength="1000" required placeholder="Write your best recipe here"></textarea>

      <label class="attachment-label" for="postImageInput">
        <span>âž• Add Attachment</span>
        <input type="file" id="postImageInput" accept="image/*" />
      </label>
      <img id="attachmentPreview" class="attachment-preview" style="display:none;" alt="Preview gambar" />

      <div class="action-row">
        <button type="button" id="cancelCreatePostBtn">Batal</button>
        <button type="submit">Post</button>
      </div>
    </form>
  </div>
</div>

<script>
  const postsData = [
    {
      title: "Persian Love Cake: Vanilla Sponge, Honey Soak, Raspberry Rose Jam, Vanilla Chantilly.",
      excerpt: "An elegant vanilla sponge with a honey soak, floral raspberry rose jam and a silky vanilla chantilly between the layers, topped with crushed pistachios.",
      image: "https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F0bc0902e-ddf8-4840-aeb8-0d250188b7a8_2634x2634.jpeg",
      content: "<p>.Thereâ€™s something truly special about transforming a simple vanilla cake into something that feels a little magical, and this cake does just that. Inspired by the romantic flavours of Persian Love Cake, itâ€™s layered with soft floral notes, juicy fruit, and just the right amount of sweetness.</p>"
    },
    {
      title: "Pistachio Olive Oil Cake: Strawberry Rose Cream, Brown Butter Honey Vanilla Soak.",
      excerpt: "Light, fluffy pistachio sponge, layered with strawberry rose infused cream and a tangy raspberry-strawberry compote.",
      image: "https://substackcdn.com/image/fetch/w_320,h_213,c_fill,f_webp,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fafe44757-b78a-4f3e-a5ba-77be0408ac43_3019x2235.jpeg",
      content: "<p>Lovely pistachio!.</p>"
    },
    {
      title: "Red Velvet Cake with Vanilla Rose Cream Cheese Frosting",
      excerpt: "Fluffy red velvet cake layered with a soft vanilla rose cream cheese frosting simple to make, beautiful to serve, and perfect for any special occasion.",
      image: "https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa8eaf323-2ea7-4f82-841d-b323d0141a45_1242x1223.jpeg",
      content: "<p>The recipe uses simple, reliable techniques like whipping the egg whites separately for extra height and alternating dry ingredients with buttermilk for a tender crumb. Paired with a light vanilla rose cream cheese frosting, itâ€™s a beautiful and approachable cake that feels just as perfect for celebrations as it does for an afternoon treat.</p>"
    },
    {
      title: "Raspberry Vanilla Baked Cheesecake",
      excerpt: "Indulge yourself in this cheesy fantastic berries paradise!.",
      image: "https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8a6b4e01-2efe-4c62-9a2b-73a3bce4788a_1242x1222.jpeg",
      content: "<p>Resep bisa tolong ke instagram saya ya! @lovelybooey.</p>"
    },
    {
      title: "Double Vanilla Chiffon Cake with Roasted Strawberries",
      excerpt: "A cake for all vanilla lovers! A strong vanilla sponge with vanilla soak, and a roasted strawberry and thick vanilla chantilly between the layers. This is a twist on the classic victoria sponge cake.",
      image: "https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F7c79e685-a2d6-4bc1-923a-9f1d0a005004_1242x1218.jpeg",
      content: "<p>Merrrily sprinkled with love! .</p>"
    }
  ];

  const postsContainer = document.getElementById('postsContainer');
  const profileBtn = document.getElementById('profileBtn');
  const profileModal = document.getElementById('profileModal');
  const closeProfileBtn = document.getElementById('closeProfileModal');
  const postModal = document.getElementById('postModal');
  const closePostBtn = document.getElementById('closePostModal');
  const postTitle = document.getElementById('postTitle');
  const postImage = document.getElementById('postImage');
  const postContent = document.getElementById('postContent');
  const postBtn = document.getElementById('postBtn');

  // Create Post Modal
  const createPostModal = document.getElementById('createPostModal');
  const closeCreatePostModal = document.getElementById('closeCreatePostModal');
  const createPostForm = document.getElementById('createPostForm');
  const postTitleInput = document.getElementById('postTitleInput');
  const postContentInput = document.getElementById('postContentInput');
  const postImageInput = document.getElementById('postImageInput');
  const attachmentPreview = document.getElementById('attachmentPreview');
  const cancelCreatePostBtn = document.getElementById('cancelCreatePostBtn');

  function renderPosts() {
    postsContainer.innerHTML = '';
    postsData.forEach((post, index) => {
      const postBox = document.createElement('div');
      postBox.className = 'post-box';
      postBox.setAttribute('tabindex', '0');
      postBox.setAttribute('role', 'button');
      postBox.setAttribute('aria-label', `Buka postingan: ${post.title}`);
      postBox.innerHTML = `
        <img class="post-image" src="${post.image}" alt="Gambar untuk ${post.title}" />
        <div class="post-content">
          <h3 class="post-title">${post.title}</h3>
          <p class="post-excerpt">${post.excerpt}</p>
        </div>
      `;
      postBox.addEventListener('click', () => openPostModal(index));
      postBox.addEventListener('keydown', e => {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          openPostModal(index);
        }
      });
      postsContainer.appendChild(postBox);
    });
  }

  // Open and close profile modal
  profileBtn.addEventListener('click', () => {
    profileModal.classList.add('active');
    profileModal.setAttribute('aria-hidden', 'false');
  });
  closeProfileBtn.addEventListener('click', closeProfileModalFunc);
  profileModal.addEventListener('click', e => {
    if (e.target === profileModal) closeProfileModalFunc();
  });
  function closeProfileModalFunc() {
    profileModal.classList.remove('active');
    profileModal.setAttribute('aria-hidden', 'true');
  }

  // Open and close post modal
  function openPostModal(index) {
    const post = postsData[index];
    postTitle.textContent = post.title;
    postImage.src = post.image;
    postImage.alt = 'Gambar untuk ' + post.title;
    postContent.innerHTML = post.content;
    postModal.classList.add('active');
    postModal.setAttribute('aria-hidden', 'false');
  }
  closePostBtn.addEventListener('click', closePostModalFunc);
  postModal.addEventListener('click', e => {
    if (e.target === postModal) closePostModalFunc();
  });
  function closePostModalFunc() {
    postModal.classList.remove('active');
    postModal.setAttribute('aria-hidden', 'true');
  }

  // POST BUTTON: Show modal form untuk posting baru
  postBtn.addEventListener('click', function() {
    createPostModal.classList.add('active');
    createPostModal.setAttribute('aria-hidden', 'false');
    // Reset form
    createPostForm.reset();
    attachmentPreview.style.display = 'none';
    attachmentPreview.src = '';
  });

  // Close and cancel new post modal
  closeCreatePostModal.addEventListener('click', closeCreatePostModalFunc);
  cancelCreatePostBtn.addEventListener('click', closeCreatePostModalFunc);
  createPostModal.addEventListener('click', e => {
    if (e.target === createPostModal) closeCreatePostModalFunc();
  });
  function closeCreatePostModalFunc() {
    createPostModal.classList.remove('active');
    createPostModal.setAttribute('aria-hidden', 'true');
  }

  // Preview image attachment
  postImageInput.addEventListener('change', function(e) {
    const file = e.target.files[0];
    if (file && file.type.startsWith('image/')) {
      const reader = new FileReader();
      reader.onload = function(ev) {
        attachmentPreview.src = ev.target.result;
        attachmentPreview.style.display = 'block';
      };
      reader.readAsDataURL(file);
    } else {
      attachmentPreview.style.display = 'none';
      attachmentPreview.src = '';
    }
  });

  // Add new post
  createPostForm.addEventListener('submit', function(e) {
    e.preventDefault();

    const title = postTitleInput.value.trim();
    const content = postContentInput.value.trim().replace(/\n/g, '<br>');
    const image = attachmentPreview.src && attachmentPreview.style.display !== 'none'
      ? attachmentPreview.src
      : 'https://images.unsplash.com/photo-1498050108023-c5249f4df085?auto=format&fit=crop&w=800&q=80';

    // Buat excerpt dari 1-2 kalimat pertama
    const plainText = postContentInput.value.trim();
    let excerpt = plainText.split(/[.!?ã€‚\n]/).slice(0,2).join('. ').substring(0, 120);
    if (excerpt.length < plainText.length) excerpt += '...';

    postsData.unshift({
      title,
      excerpt,
      image,
      content: '<p>' + content + '</p>'
    });

    renderPosts();
    closeCreatePostModalFunc();
  });

  renderPosts();
</script>
</body>
</html>
